[gd_scene load_steps=24 format=4 uid="uid://c5ce6304qt8ou"]

[ext_resource type="Script" uid="uid://c8ae6xtpnv7je" path="res://TestRoom/ColorWall.gd" id="1_c6rac"]
[ext_resource type="Material" uid="uid://cq06aob2bg0wp" path="res://Materials/Black.tres" id="1_paplp"]
[ext_resource type="PackedScene" uid="uid://cbb7dd842y1nk" path="res://Chameleon/chameleon.tscn" id="2_ixay7"]
[ext_resource type="Material" uid="uid://bo5vdhprg4pgt" path="res://Materials/Green.tres" id="2_ldo14"]
[ext_resource type="Material" uid="uid://ckl4j255q51sl" path="res://Materials/Blue.tres" id="4_ixay7"]
[ext_resource type="Material" uid="uid://hjligrw3r5ye" path="res://Materials/Red.tres" id="5_awpmd"]
[ext_resource type="Material" uid="uid://bicactxqd7qpo" path="res://Materials/White.tres" id="7_awpmd"]
[ext_resource type="Script" uid="uid://bhpq4p4tit3xa" path="res://Enemy/enemy.gd" id="8_u75uh"]
[ext_resource type="PackedScene" uid="uid://wah370kjb2eh" path="res://Enemy/enemy.tscn" id="9_v273y"]
[ext_resource type="PackedScene" uid="uid://chsl5o1jmfu47" path="res://Wall/wall.tscn" id="10_7ysk5"]
[ext_resource type="Script" uid="uid://br3nnfkyasfty" path="res://Enemy/path_follow_3d.gd" id="10_atqpo"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_paplp"]
sky_horizon_color = Color(0.662243, 0.671743, 0.686743, 1)
ground_horizon_color = Color(0.662243, 0.671743, 0.686743, 1)

[sub_resource type="Sky" id="Sky_ixay7"]
sky_material = SubResource("ProceduralSkyMaterial_paplp")

[sub_resource type="Environment" id="Environment_awpmd"]
background_mode = 2
sky = SubResource("Sky_ixay7")
tonemap_mode = 2
glow_enabled = true

[sub_resource type="BoxMesh" id="BoxMesh_c6rac"]
flip_faces = true
size = Vector3(20, 20, 20)

[sub_resource type="ArrayMesh" id="ArrayMesh_awpmd"]
_surfaces = [{
"aabb": AABB(-10, -10, -10, 20, 20, 20),
"attribute_data": PackedByteArray("AACAPwAAAD8AAIA/AAAAAKuqKj8AAAA/q6qqPgAAgD+rqqo+AAAAPwAAAAAAAIA/AACAPwAAAD+rqio/AAAAP6uqKj8AAIA/q6qqPgAAAD8AAAAAAAAAPwAAAAAAAIA/q6oqPwAAgD+rqio/AAAAP6uqqj4AAIA/q6qqPgAAAAAAAAAAAAAAAAAAAAAAAAA/AACAPwAAgD8AAIA/AAAAP6uqKj8AAIA/q6oqPwAAAD+rqio/AAAAAKuqqj4AAAA/q6qqPgAAAD+rqqo+AAAAAAAAAAAAAAA/AACAPwAAAACrqio/AAAAAKuqKj8AAAA/q6oqPwAAAD+rqqo+AAAAP6uqqj4AAIA/q6oqPwAAAACrqqo+AAAAAKuqqj4AAAA/"),
"format": 34359738391,
"primitive": 3,
"uv_scale": Vector4(0, 0, 0, 0),
"vertex_count": 36,
"vertex_data": PackedByteArray("AAAgwQAAIMEAACDBAAAgwQAAIEEAACDBAAAgQQAAIMEAACDBAAAgwQAAIMEAACBBAAAgwQAAIEEAACBBAAAgwQAAIMEAACDBAAAgQQAAIMEAACBBAAAgwQAAIMEAACBBAAAgwQAAIMEAACDBAAAgwQAAIEEAACBBAAAgwQAAIEEAACDBAAAgwQAAIMEAACDBAAAgwQAAIEEAACDBAAAgwQAAIEEAACBBAAAgQQAAIEEAACDBAAAgQQAAIEEAACBBAAAgwQAAIEEAACBBAAAgwQAAIMEAACBBAAAgQQAAIMEAACDBAAAgQQAAIMEAACBBAAAgwQAAIMEAACDBAAAgQQAAIMEAACDBAAAgQQAAIEEAACDBAAAgQQAAIMEAACBBAAAgQQAAIMEAACBBAAAgQQAAIEEAACBBAAAgwQAAIMEAACBBAAAgwQAAIEEAACDBAAAgQQAAIEEAACDBAAAgQQAAIMEAACDBAAAgwQAAIEEAACBBAAAgQQAAIEEAACBBAAAgQQAAIEEAACDBAAAgQQAAIEEAACDBAAAgQQAAIEEAACBBAAAgQQAAIMEAACBB/3//fwAA/z//f/9/AAD/P/9//38AAP8/////f/9//z////9//3//P////3//f/8//3///////z//f///////P/9///////8/////f/9//z////9//3//P////3//f/8//38AAAAA/z//fwAAAAD/P/9/AAAAAP8//////////z//////////P/////////8//3///////z//f///////P/9///////8/AAD/f///AAAAAP9///8AAAAA/3///wAA/////////z//////////P/////////8//3//fwAA/z//f/9/AAD/P/9//38AAP8//38AAAAA/z//fwAAAAD/P/9/AAAAAP8/AAD/f///AAAAAP9///8AAAAA/3///wAA")
}]

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_awpmd"]
data = PackedVector3Array(-2.5, 2.5, 0.5, 2.5, 2.5, 0.5, -2.5, -2.5, 0.5, 2.5, 2.5, 0.5, 2.5, -2.5, 0.5, -2.5, -2.5, 0.5, 2.5, 2.5, -0.5, -2.5, 2.5, -0.5, 2.5, -2.5, -0.5, -2.5, 2.5, -0.5, -2.5, -2.5, -0.5, 2.5, -2.5, -0.5, 2.5, 2.5, 0.5, 2.5, 2.5, -0.5, 2.5, -2.5, 0.5, 2.5, 2.5, -0.5, 2.5, -2.5, -0.5, 2.5, -2.5, 0.5, -2.5, 2.5, -0.5, -2.5, 2.5, 0.5, -2.5, -2.5, -0.5, -2.5, 2.5, 0.5, -2.5, -2.5, 0.5, -2.5, -2.5, -0.5, 2.5, 2.5, 0.5, -2.5, 2.5, 0.5, 2.5, 2.5, -0.5, -2.5, 2.5, 0.5, -2.5, 2.5, -0.5, 2.5, 2.5, -0.5, -2.5, -2.5, 0.5, 2.5, -2.5, 0.5, -2.5, -2.5, -0.5, 2.5, -2.5, 0.5, 2.5, -2.5, -0.5, -2.5, -2.5, -0.5)

[sub_resource type="BoxMesh" id="BoxMesh_u75uh"]
size = Vector3(5, 5, 1)

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_awpmd"]

[sub_resource type="CapsuleMesh" id="CapsuleMesh_u75uh"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_v273y"]
albedo_color = Color(0.255903, 0.430431, 0.452611, 1)

[sub_resource type="CapsuleMesh" id="CapsuleMesh_7ysk5"]
radius = 0.39
height = 1.01

[sub_resource type="Curve3D" id="Curve3D_m2fxc"]
closed = true
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, -7.84831, 0.00145721, -3.30075, 0, 0, 0, 0, 0, 0, -24.0454, 0.00206757, -3.38334, 0, 0, 0, 0, 0, 0, -23.9956, -0.0104713, 14.1705, 0, 0, 0, 0, 0, 0, -8.04194, -0.0101967, 13.9461, 0, 0, 0, 0, 0, 0, 21.4483, -0.00788116, 14.621, 0, 0, 0, 0, 0, 0, 20.9886, 0.00257111, -3.08238),
"tilts": PackedFloat32Array(0, 0, 0, 0, 0, 0)
}
point_count = 6

[node name="TestRoom" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_awpmd")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.866025, -0.433013, 0.25, 0, 0.5, 0.866025, -0.5, 0.75, -0.433013, 0, 0, 0)
shadow_enabled = true

[node name="CSGMesh3D" type="CSGMesh3D" parent="."]
transform = Transform3D(2.99862, 0, 0, 0, 1, 0, 0, 0, 2.3742, 0, 10, 0)
material_override = ExtResource("1_paplp")
use_collision = true
collision_layer = 2
collision_mask = 13
mesh = SubResource("BoxMesh_c6rac")
script = ExtResource("1_c6rac")
materials = Array[StandardMaterial3D]([ExtResource("1_paplp")])
value_color = 0

[node name="MeshInstance3D" type="MeshInstance3D" parent="CSGMesh3D"]
mesh = SubResource("ArrayMesh_awpmd")
skeleton = NodePath("../..")

[node name="Chameleon" parent="." instance=ExtResource("2_ixay7")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10.1233, 0, -2.83759)

[node name="Wall" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6.86963, 2.5, -7.34293)
collision_layer = 2
collision_mask = 13
script = ExtResource("1_c6rac")
materials = Array[StandardMaterial3D]([ExtResource("1_paplp"), ExtResource("4_ixay7"), ExtResource("2_ldo14"), ExtResource("5_awpmd"), ExtResource("7_awpmd")])
value_color = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="Wall"]
shape = SubResource("ConcavePolygonShape3D_awpmd")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Wall"]
material_override = ExtResource("2_ldo14")
mesh = SubResource("BoxMesh_u75uh")
skeleton = NodePath("../..")

[node name="Wall2" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.45248, 2.5, -7.34293)
collision_layer = 2
collision_mask = 13
script = ExtResource("1_c6rac")
materials = Array[StandardMaterial3D]([ExtResource("1_paplp"), ExtResource("4_ixay7"), ExtResource("2_ldo14"), ExtResource("5_awpmd"), ExtResource("7_awpmd")])
value_color = 3

[node name="CollisionShape3D" type="CollisionShape3D" parent="Wall2"]
shape = SubResource("ConcavePolygonShape3D_awpmd")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Wall2"]
material_override = ExtResource("4_ixay7")
mesh = SubResource("BoxMesh_u75uh")
skeleton = NodePath("../..")

[node name="Wall3" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4.49733, 2.5, -7.34293)
collision_layer = 2
collision_mask = 13
script = ExtResource("1_c6rac")
materials = Array[StandardMaterial3D]([ExtResource("1_paplp"), ExtResource("4_ixay7"), ExtResource("2_ldo14"), ExtResource("5_awpmd"), ExtResource("7_awpmd")])

[node name="CollisionShape3D" type="CollisionShape3D" parent="Wall3"]
shape = SubResource("ConcavePolygonShape3D_awpmd")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Wall3"]
material_override = ExtResource("5_awpmd")
mesh = SubResource("BoxMesh_u75uh")
skeleton = NodePath("../..")

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 7, 0)
visible = false
projection = 1
size = 20.0

[node name="Enemy" type="CharacterBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.86561, 0, 3.89889)
visible = false
script = ExtResource("8_u75uh")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Enemy"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
visible = false
shape = SubResource("CapsuleShape3D_awpmd")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Enemy"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
visible = false
mesh = SubResource("CapsuleMesh_u75uh")

[node name="MeshInstance3D2" type="MeshInstance3D" parent="Enemy"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 1.39205, -0.337506)
visible = false
material_override = SubResource("StandardMaterial3D_v273y")
mesh = SubResource("CapsuleMesh_7ysk5")

[node name="RayCast3D" type="RayCast3D" parent="Enemy"]
visible = false
target_position = Vector3(0, 0, -20)

[node name="Wall4" parent="." instance=ExtResource("10_7ysk5")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.46798, 6.27678)

[node name="Wall5" parent="." instance=ExtResource("10_7ysk5")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6.48871, 2.49664, 6.2863)
value_color = 2

[node name="Path3D" type="Path3D" parent="."]
curve = SubResource("Curve3D_m2fxc")

[node name="PathFollow3D" type="PathFollow3D" parent="Path3D"]
transform = Transform3D(0.00509897, 3.76823e-05, 0.999984, 0, 0.999998, -3.76827e-05, -0.999983, 1.92144e-07, 0.00509898, -7.84831, 0.00145721, -3.30075)
script = ExtResource("10_atqpo")

[node name="Enemy2" parent="Path3D/PathFollow3D" instance=ExtResource("9_v273y")]
transform = Transform3D(0.999794, -6.69826e-11, 0.0204217, -7.69531e-07, 1, 3.76746e-05, -0.0204217, -3.76824e-05, 0.999796, -0.0747132, -0.126672, -0.227385)

[connection signal="find_chameleon" from="Path3D/PathFollow3D/Enemy2" to="Path3D/PathFollow3D" method="_on_enemy_2_find_chameleon"]
[connection signal="lost_chameleon" from="Path3D/PathFollow3D/Enemy2" to="Path3D/PathFollow3D" method="_on_enemy_2_lost_chameleon"]
